<!DOCTYPE html>
<html>
<head>
  <title>Delete Account</title>
</head>
<body>
  <h1>Delete Your Account</h1>

  <div id="loginDiv">
    <input type="email" id="email" placeholder="Email"><br><br>
    <input type="password" id="password" placeholder="Password"><br><br>
    <button onclick="login()">Login</button>
  </div>

  <div id="deleteDiv" style="display:none">
    <p>Logged in as <span id="userEmail"></span></p>
    <button onclick="deleteAccount()">Delete Account Permanently</button>
  </div>

  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-functions.js"></script>

  <script>
    // Initialize Firebase
    const firebaseConfig = { /* your config here */ };
    firebase.initializeApp(firebaseConfig);

    const auth = firebase.auth();
    const functions = firebase.functions();

    async function login() {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;

      try {
        const userCredential = await auth.signInWithEmailAndPassword(email, password);
        const user = userCredential.user;
        document.getElementById("loginDiv").style.display = "none";
        document.getElementById("deleteDiv").style.display = "block";
        document.getElementById("userEmail").innerText = user.email;
      } catch (err) {
        alert("Login failed: " + err.message);
      }
    }

    async function deleteAccount() {
      const deleteFn = functions.httpsCallable("deleteAccount");
      try {
        await deleteFn();
        alert("Your account has been permanently deleted.");
        auth.signOut();
        document.getElementById("deleteDiv").style.display = "none";
        document.getElementById("loginDiv").style.display = "block";
      } catch (err) {
        alert("Deletion failed: " + err.message);
      }
    }
  </script>
</body>
</html>
